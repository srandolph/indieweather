<!DOCTYPE html>
<html>
<head>

<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
	type="text/javascript"></script>
<script type="text/javascript">
	function underWeather(zipcode) {
				debugger;
		var wugUrl = 'http://api.wunderground.com/api/9c801015ba7ec9b0/forecast/geolookup/q/'
				+ zipcode + '.json';
		$.ajax({
			url: wugUrl,
			dataType: "jsonp",
			beforeSend: function(){
									alert(this.url);
                   $('#spinner').show();
                   },
			success: function(parsed_json) {
				alert(' Success');
						$('#spinner').hide();
				var location = parsed_json['location']['city'];
				var temp_f = parsed_json['current_observation']['temp_f'];
				alert("Current temperature in " + location + " is: " + temp_f);
			}
		});
	}
</script>

<script type="text/javascript">
	function IsValidZipCode(zip) {
		var isValid = /^[0-9]{5}(?:-[0-9]{4})?$/.test(zip);
		if (isValid) {
			alert(zip + ' ZipCode');
			underWeather(zip);
		} else {
			alert('Invalid ZipCode');
		}
	}
</script>

<script type="text/javascript">
$(document).ready(function(){
    $("#spinner").bind("ajaxSend", function() {
        $(this).show();
    }).bind("ajaxStop", function() {
        $(this).hide();
    }).bind("ajaxError", function() {
        $(this).hide();
    });

     });
</script>
<div id="spinner" class="spinner" style="display:none;">
    <img id="img-spinner" src="spinner.gif" alt="Loading"/>
</div>
<style>
.spinner {
    position: fixed;
    top: 50%;
    left: 50%;
    margin-left: -50px; /* half width of the spinner gif */
    margin-top: -50px; /* half height of the spinner gif */
    text-align:center;
    z-index:1234;
    overflow: auto;
    width: 100px; /* width of the spinner gif */
    height: 102px; /*hight of the spinner gif +2px to fix IE8 issue */
}
</style>

</head>

<body>

	<h1>IndieCIO Weather</h1>

	<p id="demo">Enter Zip Code</p>
	<form action="">
		<input id="txtZip" name="zip" type="text" /> <input id="Button1"
			type="submit" value="Enter"
			onclick="IsValidZipCode(this.form.zip.value)" /><br />
	</form>

	<p>
		<a href="https://github.com/srandolph/indieweather">Code on
			srandolph Github</a>
	</p>

</body>
</html>
